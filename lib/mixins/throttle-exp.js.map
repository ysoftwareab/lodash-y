{"version":3,"sources":["../../src/mixins/throttle-exp.ts"],"names":[],"mappings":"wGAAA,wD;;;;;;AAMA;;;;;;;;;;;;;;;;AAgBO,IAAI,WAAW,GAAG,UAAuB,MAAvB,EAAkC,IAAlC,EAAgD,OAMxE;;;;;;AAAG,EANqB,EAMC;AACxB,kBAAE,QAAF,CAAW,OAAX,EAAoB;AAClB,IAAA,OAAO,EAAE,IADS;AAElB,IAAA,QAAQ,EAAE,IAFQ;AAGlB,IAAA,UAAU,EAAE,CAHM;AAIlB,IAAA,OAAO,EAAE,QAJS;AAKlB,IAAA,OAAO,EAAE,QALS,EAApB;;AAOA,MAAI,KAAJ;AACA,MAAI,UAAJ;AACA,MAAI,QAAJ;;AAEA,MAAI,OAAJ;AACA,MAAI,YAAY,GAAG,KAAnB;;AAEA,MAAI,QAAQ,GAAG,YAAiB;AAC9B,QAAI;AACF,MAAA,QADE;AAEF,MAAA,QAFE;AAGA,IAAA,QAHJ;;AAKA,IAAA,QAAQ,GAAG,SAAX;;AAEA,IAAA,UAAU,GAAG,MAAM,CAAC,KAAP,CAAa,QAAb,EAAuB,QAAvB,CAAb;AACD,GATD;;AAWA,MAAI,UAAU,GAAG,YAAiB;AAChC,IAAA,QAAQ;AACR,QAAI,OAAO,CAAC,OAAZ,EAAqB;AACnB,MAAA,QAAQ;AACT;AACF,GALD;;AAOA,MAAI,WAAW,GAAG,YAAiB;AACjC,QAAI,OAAO,CAAC,QAAR,IAAoB,CAAC,gBAAE,WAAF,CAAc,QAAd,CAAzB,EAAkD;AAChD,MAAA,QAAQ;AACR,MAAA,QAAQ;AACT;AACF,GALD;;AAOA,MAAI,UAAU,GAAG,YAAiB;AAChC,QAAI,gBAAE,WAAF,CAAc,KAAd,CAAJ,EAA0B;AACxB;AACD;;AAED,IAAA,YAAY,CAAC,KAAD,CAAZ;AACA,IAAA,KAAK,GAAG,SAAR;AACD,GAPD;;AASA,MAAI,OAAO,GAAG,YAAiB;AAC7B,IAAA,UAAU;AACV,IAAA,WAAW;AACZ,GAHD;;AAKA,MAAI,QAAQ,GAAG,YAAiB;AAC9B,QAAI,CAAC,gBAAE,WAAF,CAAc,KAAd,CAAL,EAA2B;AACzB;AACD;;AAED,QAAI,gBAAE,WAAF,CAAc,OAAd,CAAJ,EAA4B;AAC1B,MAAA,OAAO,GAAG,IAAV,CAD0B,CACV;AACjB,KAFD,MAEO,IAAI,YAAJ,EAAkB;AACvB,MAAA,OAAO,GAAG,OAAO,GAAG,OAAO,CAAC,UAA5B;AACD,KAFM,MAEA;AACL,MAAA,OAAO,GAAG,OAAO,GAAG,OAAO,CAAC,OAA5B;AACD;;AAED,IAAA,YAAY,GAAG,KAAf;;AAEA,IAAA,OAAO,GAAG,gBAAE,KAAF,CAAQ,OAAR,EAAiB,IAAjB,EAAuB,OAAO,CAAC,OAA/B,CAAV;;AAEA,IAAA,KAAK,GAAG,UAAU,CAAC,OAAD,EAAU,OAAV,CAAlB;AACD,GAlBD;;AAoBA,MAAI,EAAE,GAAG,gBAAE,MAAF,CAAS,UAAS,GAAG,IAAZ,EAAgD;AAChE,IAAA,QAAQ,GAAG;AACT;AACA,MAAA,QAAQ,EAAE,IAFD;AAGT,MAAA,QAAQ,EAAE,IAHD,EAAX;;;AAMA,QAAI,CAAC,gBAAE,WAAF,CAAc,KAAd,CAAL,EAA2B;AACzB,MAAA,YAAY,GAAG,IAAf;AACA,aAAO,UAAP;AACD;;AAED,IAAA,UAAU;;AAEV,WAAO,UAAP;AACD,GAfQ,EAeD;AACN,IAAA,MAAM,EAAE,YAAW;AACjB,MAAA,UAAU;AACV,MAAA,QAAQ,GAAG,SAAX;AACD,KAJK;;AAMN,IAAA,KAAK,EAAE,YAAW;AAChB,MAAA,UAAU;AACV,MAAA,WAAW;AACX,aAAO,UAAP,CAHgB,CAGG;AACpB,KAVK,EAfC,CAAT;;;AA4BA,SAAO,EAAP;AACD,CA7GM,C","file":"throttle-exp.js","sourcesContent":["import _ from 'lodash';\n\nimport {\n  Fn\n} from '../types';\n\n/**\n * Part of `lodash-firecloud`.\n *\n * Throttle a function exponentially.\n *\n * @param origFn Function to throttle.\n * @param wait Starting (minimum) wait time.\n * @param options Options.\n * @param [options.leading=true] Specifies if `origFn` should be invoked on leading edge.\n * @param [options.trailing=true] Specifies if `origFn` should be invoked on trailing edge.\n * @param [options.maxWait=Infinity] Specifies max value of `wait` as it exponentially grows.\n * @param [options.multiplier=2] Specifies a multiplier for `wait` applied on every actual invocation.\n * @param [options.divider=Infinity] Specifies a divider for `wait` used on actual invocation\n * if the previous call was not throttled.\n * @returns The throttled function.\n */\nexport let throttleExp = function<T extends Fn>(origFn: T, wait: number, options: {\n  leading?: boolean,\n  trailing?: boolean,\n  multiplier?: number,\n  divider?: number,\n  maxWait?: number\n} = {}): T & _.Cancelable {\n  _.defaults(options, {\n    leading: true,\n    trailing: true,\n    multiplier: 2,\n    divider: Infinity,\n    maxWait: Infinity\n  });\n  let timer;\n  let lastResult;\n  let lastCall;\n\n  let curWait;\n  let wasThrottled = false;\n\n  let invokeFn = function(): void {\n    let {\n      lastThis,\n      lastArgs\n    } = lastCall;\n\n    lastCall = undefined;\n\n    lastResult = origFn.apply(lastThis, lastArgs);\n  };\n\n  let tryLeading = function(): void {\n    setTimer();\n    if (options.leading) {\n      invokeFn();\n    }\n  };\n\n  let tryTrailing = function(): void {\n    if (options.trailing && !_.isUndefined(lastCall)) {\n      setTimer();\n      invokeFn();\n    }\n  };\n\n  let clearTimer = function(): void {\n    if (_.isUndefined(timer)) {\n      return;\n    }\n\n    clearTimeout(timer);\n    timer = undefined;\n  };\n\n  let onTimer = function(): void {\n    clearTimer();\n    tryTrailing();\n  };\n\n  let setTimer = function(): void {\n    if (!_.isUndefined(timer)) {\n      return;\n    }\n\n    if (_.isUndefined(curWait)) {\n      curWait = wait; // first call\n    } else if (wasThrottled) {\n      curWait = curWait * options.multiplier;\n    } else {\n      curWait = curWait / options.divider;\n    }\n\n    wasThrottled = false;\n\n    curWait = _.clamp(curWait, wait, options.maxWait);\n\n    timer = setTimeout(onTimer, curWait);\n  };\n\n  let fn = _.assign(function(...args: Parameters<T>): ReturnType<T> {\n    lastCall = {\n      // eslint-disable-next-line babel/no-invalid-this\n      lastThis: this,\n      lastArgs: args\n    };\n\n    if (!_.isUndefined(timer)) {\n      wasThrottled = true;\n      return lastResult;\n    }\n\n    tryLeading();\n\n    return lastResult;\n  } as T, {\n    cancel: function() {\n      clearTimer();\n      lastCall = undefined;\n    },\n\n    flush: function() {\n      clearTimer();\n      tryTrailing();\n      return lastResult; // as per original _.debounce\n    }\n  });\n\n  return fn;\n};\n"]}